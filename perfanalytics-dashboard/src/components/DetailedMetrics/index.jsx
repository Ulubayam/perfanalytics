import React, {useState, lazy, Suspense} from 'react';
import Grid from "@material-ui/core/Grid";
import {makeStyles} from "@material-ui/core/styles";
import MetricCard from "../MetricCard";

const FileList = lazy(() => import('../FileList'));

const useStyles = makeStyles((theme) => ({
  root: {
    display: 'flex',
    padding: 10
  },
  margin: {
    margin: theme.spacing(1),
  }
}));

export default function DetailedMetrics({name, metrics}) {
  let [currentIndex, setCurrentIndex] = useState(metrics.data.length - 1)
  const classes = useStyles();

  const isFirst = () => currentIndex === 0
  const isLast = () => currentIndex === metrics.data.length - 1

  const next = () => {
    setCurrentIndex(currentIndex + 1)
  }

  const previous = () => {
    setCurrentIndex(currentIndex - 1)
  }

  return (
    <Grid container spacing={3} className={classes.root}>
      <Grid item xs={12} md={4} lg={4}>
        <MetricCard metric={metrics.data[currentIndex]}
                    next={next}
                    disableNext={isLast()}
                    previous={previous}
                    disablePrevious={isFirst()} />
      </Grid>
      <Grid item xs={12} md={8} lg={8}>
        <Suspense fallback={<span/>}>
          <FileList files={metrics?.data[currentIndex]?.files} />
        </Suspense>
      </Grid>
    </Grid>
  );
}
